<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">
<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
    <id>TapatalkSMFPlugin:TapatalkDevelopmentTeam</id>
    <file name="$sourcedir/Load.php">
        <operation>
            <search position="after"><![CDATA[	$context['menu_separator'] = !empty($settings['use_image_buttons']) ? ' ' : ' | ';]]></search>
            <add><![CDATA[	$jsfile_name = ( $modSettings['tp_tapatalkNotifierForChromeEnabled'] && $context['browser']['is_chrome'] ) ? "tapatalkdetect.js" :"tapatalkdetect-nochrome.js";
	$context['html_headers'] .= '<script type="text/javascript" language="JavaScript" src="' . $boardurl . '/mobiquo/'.$jsfile_name.'"></script>';
]]></add>
        </operation>
    </file>
        <file name="$sourcedir/Post.php">
        <operation>
            <search position="replace"><![CDATA[			// Only send it to everyone if the topic is approved, otherwise just to the topic starter if they want it.
			if ($topic_info['approved'])
				sendNotifications($topic, 'reply');]]></search>
            <add><![CDATA[			// Only send it to everyone if the topic is approved, otherwise just to the topic starter if they want it.
			if ($topic_info['approved'])
			{
				sendNotifications($topic, 'reply');
				global $boarddir;
				if (function_exists('tapatalk_push'))
					tapatalk_push_reply($msgOptions['id']);
				else if(file_exists($boarddir . '/mobiquo/push_hook.php'))
				{
					include($boarddir . '/mobiquo/push_hook.php');
					tapatalk_push_reply($msgOptions['id']);
				}
			}]]></add>
        </operation>
    </file>
        <file name="$sourcedir/PersonalMessage.php">
        <operation>
            <search position="replace"><![CDATA[	// Message sent successfully?
	if (!empty($context['send_log']) && empty($context['send_log']['failed']))
		$context['current_label_redirect'] = $context['current_label_redirect'] . ';done=sent';]]></search>
            <add><![CDATA[	// Message sent successfully?
	if (!empty($context['send_log']) && empty($context['send_log']['failed']))
	{
		$context['current_label_redirect'] = $context['current_label_redirect'] . ';done=sent';
		global $boarddir;
		if (function_exists('tapatalk_push'))
		tapatalk_push_pm();
		else if(file_exists($boarddir . '/mobiquo/push_hook.php'))
		{
			include($boarddir . '/mobiquo/push_hook.php');
			tapatalk_push_pm();
		}
	}]]></add>
        </operation>
    </file>
        </file>
        <file name="$sourcedir/Admin.php">
        <operation>
            <search position="replace"><![CDATA[	// Any files to include for administration?
	if (!empty($modSettings['integrate_admin_include']))]]></search>
            <add><![CDATA[	$modSettings['integrate_admin_include'] = $modSettings['integrate_admin_include'].",\$sourcedir/Subs-Tapatalk.php";
	$modSettings['integrate_admin_areas'] = $modSettings['integrate_admin_areas'].",Tapatalk_add_admin_areas";
	// Any files to include for administration?
	if (!empty($modSettings['integrate_admin_include']))]]></add>
        </operation>
    </file>
        <file name="$themedir/languages/Admin.english.php">
        <operation>
            <search position="after"><![CDATA[?>]]></search>
            <add><![CDATA[//Tapatalk
$txt['tapatalktitle'] = 'Tapatalk Settings';
$txt['tp_general_settings'] = 'General';
$txt['tp_other_settings'] = 'Others';
$txt['tp_board_settings'] = 'Boards';]]></add>
        </operation>
        </file>
        <file name="$themedir/languages/ManageSettings.english.php">
        <operation>
            <search position="after"><![CDATA[?>]]></search>
            <add><![CDATA[//Tapatalk
$txt['tapatalktitle'] = 'Tapatalk Settings';
$txt['tp_pushEnabled'] = 'Enable push for Tapatalk users';
$txt['tapatalkEnabled'] = 'Enable tapatalk';
$txt['tp_guestOkayEnabled'] = 'Enable forum view for guest by tapatalk';
$txt['tp_tapatalkNotifierForChromeEnabled'] = 'Enable Tapatalk Notifier in Chrome';
$txt['tp_general_settings'] = 'General';
$txt['tp_board_settings'] = 'Boards';
$txt['tp_other_settings'] = 'Others';
$txt['tp_parent_board'] = 'Boards1';
$txt['tp_child_board'] = 'Boards2';
$txt['tp_board_settingsDesc'] = 'Set the board you want to hide to tapatalk users';
$txt['tp_general_settingsDesc'] = 'This is the general settings for tapatalk';
$txt['tp_other_settingsDesc'] = 'Taptalk information';
$txt['tp_select_boards'] = 'Select Boards to HIDE on Tapatalk';
$txt['tp_register_page_url'] = 'Register page url';
$txt['taptalk_descp'] = '<strong>Tapatalk for SMF Plugin</strong></br>
For SMF 2.0 RC4/RC5/Final, <a href = "http://www.tapatalk.com">http://www.tapatalk.com</a></br></br>

<b>What is Tapatalk?</b></br>
Tapatalk is a forum app for iPhone/iPad, Android, BlackBerry, Windows Phone and WebOS. The app provides super fast forum access to any vBulletin, IPBoard, phpBB, SMF, xenForo, MyBB and Kunena forums that have activated Tapatalk. Forum owner can download the free plug-in to activate Tapatalk in your forum.</br>

<b>What does this mod do?</b></br>
This mod enables your forum to be accessed by the Tapatalk app. The Tapatalk app can be downloaded from Apple iTune Store or from Google Android Market.</br>

<b>What next do I have to do?</b></br>
After installing this mod, head straight to <a href = "http://tapatalk.com/activate_tapatalk.php">http://tapatalk.com/activate_tapatalk.php</a> and register there. After registering you can enlist your forum into the Tapatalk network.</br>
</br>
Please manually change permission of all files under mobiquo/ folder (including the folder itself) to chmod 755 otherwise it won\'t work!!</br>
</br>
For more information please visit tapatalk.com</br>

Thank you! :)';]]></add>
        </operation>
        </file>
</modification>